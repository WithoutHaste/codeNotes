## AJAX

# Vanilla Javascript AJAX

<code>
// options {
//		type: 'post',
//		url: 'google.com',
//		data: { },
//		success: callback,
//		error: callback
// }
async function ajax(options) {
	var xhr = new XMLHttpRequest();
	xhr.onreadystatechange = onReadyStateChange;
	xhr.open(options.type, options.url);
	
	if(

	if (options.dataIsJson == null || options.dataIsJson == true) {
		let formData = new FormData();
		Object.entries(options.data).forEach(([key, value], index) => {
console.log("formdata " + key + " " + value);
			formData.append(key, value);
		});
console.log(formData);
		xhr.send(formData);
//			xhr.setRequestHeader("Content-type", "text/json");
//			xhr.send(JSON.stringify(options.data));
	}
	else {
		xhr.send(options.data);
	}

	function onReadyStateChange() {
		const DONE = 4; // readyState 4 means the request is done.
		const OK = 200; // status 200 is a successful return.
		if (xhr.readyState === DONE) {
			if (xhr.status === OK) 
				options.success(JSON.parse(xhr.response));
			else 
				options.error(xhr, xhr.status, xhr.response);
		}
	}
}
</code>

You cannot "send" data with a "GET" request. You can only use query string parameters with "GET".

# FormData

You can easily pull data from a form with
<code>
let form = document.getElementById("myForm");
let formData = new FormData(form);
xhr.send(formData);
</code>

Or build it manually
<code>
let formData = new FormData();
formData.append("key", "value");
</code>
